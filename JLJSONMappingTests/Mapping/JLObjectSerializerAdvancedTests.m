//
//  JLObjectSerializerAdvancedTests.m
//  JLJSONMapping
//
//  Created by Joshua Liebowitz on 7/20/13.
//  Copyright (c) 2013 Joshua Liebowitz. All rights reserved.
//

#import <XCTest/XCTest.h>
#import "ComplicatedTestObject.h"
#import "JLObjectDeserializer.h"
#import "JLObjectSerializer.h"
#import "SimpleTestObject.h"
#import "XCTestCase+Util.h"

static NSString * const expectedTestObjectString32Bit = @"{\"dictionaryOfSimpleTestObjects\":{\"3\":{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":3,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},\"1\":{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":1,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},\"4\":{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":4,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},\"2\":{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":2,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},\"0\":{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":0,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},\"5\":{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":5,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451}},\"simpleTestObject\":{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":32123,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},\"setOfSimpleTestObjects\":[{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":11,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":15,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":14,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":10,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":12,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":13,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451}],\"arrayOfSimpleTestObjects\":[{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":0,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":1,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":2,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":3,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":4,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451},{\"pBoolean\":1,\"boolean\":1,\"pLongLong\":5432,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\",\"pInt64\":64,\"cgfloat\":22.1,\"pInt16\":16,\"pUnsignedChar\":254,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"pLong\":5432,\"uInteger\":9238,\"pUnsignedLong\":64545,\"number\":432,\"pUnsignedShort\":6,\"integer\":5,\"pUnsignedInt\":2223,\"pDouble\":2123.23,\"pChar\":42,\"pInt\":321,\"pInt32\":32,\"pFloat\":2.3,\"pShort\":2,\"pUnsignedLongLong\":5443451}]}";

static NSString * const expectedTestObjectString64Bit = @"{\"setOfSimpleTestObjects\":[{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":13,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"},{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":14,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"},{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":12,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"},{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":10,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"},{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":11,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"},{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":15,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"}],\"arrayOfSimpleTestObjects\":[{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":0,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"},{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":1,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"},{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":2,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"},{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":3,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"},{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":4,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"},{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":5,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"}],\"dictionaryOfSimpleTestObjects\":{\"3\":{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":3,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"},\"1\":{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":1,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"},\"4\":{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":4,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"},\"2\":{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":2,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"},\"0\":{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":0,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"},\"5\":{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":5,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"}},\"simpleTestObject\":{\"pUnsignedChar\":254,\"pFloat\":2.3,\"pLong\":5432,\"pInt16\":16,\"pInt64\":64,\"pChar\":42,\"pShort\":2,\"number\":432,\"pUnsignedShort\":6,\"date\":\"2009-02-13T15:31:30.012 -0800\",\"cgfloat\":22.1,\"pInt32\":32,\"pLongLong\":5432,\"pDouble\":2123.23,\"pUnsignedLong\":64545,\"boolean\":1,\"pUnsignedLongLong\":5443451,\"uInteger\":9238,\"pUnsignedInt\":2223,\"pInt\":321,\"pBoolean\":1,\"integer\":32123,\"string\":\"hey there, I'm a test string, here have some unicode: Ω≈ç√∫˜µœ∑´®†¥¨ˆøπ“‘æ…¬˚∆˙©ƒ∂ßåΩ≈ç√∫˜µ≤≥÷™£¢∞§¶•ªº\"}}";

@interface JLObjectSerializerAdvancedTests : XCTestCase

@end

@implementation JLObjectSerializerAdvancedTests
{
    JLObjectSerializer *serializer;
    JLObjectDeserializer *deserializer;
}

- (void)setUp
{
    serializer = [[JLObjectSerializer alloc] init];
    deserializer = [[JLObjectDeserializer alloc] init];
    [super setUp];
}

- (void)testEntireObjectSerializationInOrder
{
    serializer = [[JLObjectSerializer alloc] initWithSerializerOptions:JLSerializerOptionDefaultOptionsMask];
    if ([XCTestCase is64Bit]) {
        [self sixtyFourBitTestEntireObjectSerialization];
    } else {
        [self thirtyTwoBitTestEntireObjectSerialization];
    }
}

- (void)thirtyTwoBitTestEntireObjectSerialization
{
    ComplicatedTestObject *testObject = [ComplicatedTestObject newComplicatedTestObject];
    NSString *objectString = [serializer JSONStringWithObject:testObject];
    NSError *error;
    ComplicatedTestObject *testBack = [deserializer objectWithString:objectString targetClass:[ComplicatedTestObject class] error:&error];
    XCTAssertEqual([objectString length], [expectedTestObjectString32Bit length], @"String length should match");
    XCTAssertEqualObjects(testObject, testBack, @"Objects should be equal to eachother");
}

- (void)sixtyFourBitTestEntireObjectSerialization
{
    ComplicatedTestObject *testObject = [ComplicatedTestObject newComplicatedTestObject];
    NSString *objectString = [serializer JSONStringWithObject:testObject];
    NSError *error;
    ComplicatedTestObject *testBack = [deserializer objectWithString:objectString targetClass:[ComplicatedTestObject class] error:&error];
    XCTAssertEqual([objectString length], [expectedTestObjectString64Bit length], @"String length should match");
    XCTAssertEqualObjects(testObject, testBack, @"Objects should be equal to eachother");
}

// test to compare running times of using dispatch_once on the date formatter in NSObject+JLJSONMapping
//vs creating a new NSDateFormatter
- (void)testDateFormatter
{
    NSMutableArray *objects = [@[] mutableCopy];
    for (int i = 0; i < 1000; i++)
    {
        SimpleTestObject *testObject = [[SimpleTestObject alloc] init];
        [testObject setDate:[[NSDate alloc] initWithTimeIntervalSince1970:i]];
        [objects addObject:testObject];
    }
    CFAbsoluteTime startTime = CFAbsoluteTimeGetCurrent();
    NSString *json = [serializer JSONStringWithObject:objects];
    CFAbsoluteTime taskTime = (CFAbsoluteTimeGetCurrent() - startTime);
    NSLog(@"Serializer took:%f", taskTime);
    JLObjectDeserializer *d = [[JLObjectDeserializer alloc] initWithDeserializerOptions:JLDeserializerOptionDefaultOptionMask];
    startTime = CFAbsoluteTimeGetCurrent();
    NSError *error;
    NSArray *backagain = [d objectWithString:json targetClass:[SimpleTestObject class] error:&error];
    taskTime = (CFAbsoluteTimeGetCurrent() - startTime);
    NSLog(@"Deserializer took:%f", taskTime);
    XCTAssertEqual([backagain count], 1000);
    XCTAssertNil(error);
}

@end
